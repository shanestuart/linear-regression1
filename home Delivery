import pandas as pd
import numpy as np
from sklearn.linear_model import LinearRegression
import matplotlib.pyplot as plt

delv=pd.read_csv('/content/drive/MyDrive/Food_Delivery_Times.csv')
print(delv)


delv.head(20)


delv.isnull()


delv.dropna(inplace=True)
print(delv)

delv.isnull().sum()

inp = delv[['Distance_km', 'Preparation_Time_min', 'Courier_Experience_yrs']]
out = delv[['Delivery_Time_min']]

LR=LinearRegression()

LR.fit(inp,out)

from sklearn.preprocessing import LabelEncoder
le_1=LabelEncoder()
le_2=LabelEncoder()
le_3=LabelEncoder()

delv['Traffic_Level']=le_1.fit_transform(delv['Traffic_Level'])



delv.head()


1dis=float(input("enter the distance"))
prep=int(input("enter the preparation time"))
exp=float(input("enter the experience"))
LR.predict(np.array([[dis, prep, exp]]))


dec=le_1.inverse_transform(delv['Traffic_Level'])
print(dec)

import matplotlib.pyplot as plt


predictions=LR.predict(inp)
plt.scatter(out,predictions)
plt.plot([out.min(),out.max()],[out.min(),out.max()],'k--',lw=2)
plt.xlabel("moodu")
plt.ylabel("soodu")
plt.title("thinnu")
plt.show()

import seaborn as sns

inp = delv[['Distance_km', 'Preparation_Time_min', 'Courier_Experience_yrs']]
out = delv[['Delivery_Time_min']]

df = pd.DataFrame(inp)
df = pd.DataFrame(out)



corr = df.corr()


fig, ax = plt.subplots(figsize=(6, 4))
sns.heatmap(corr, annot=True, cmap="coolwarm")
plt.title("Correlation Heatmap")
plt.show()

plt.title("Correlation Heatmap")
plt.show()




delv.to_pickle('homedelivery_data.pkl')
print("DataFrame 'delv' saved to homedelivery_data.pkl")

from google.colab import files
files.download('homedelivery_data.pkl')
